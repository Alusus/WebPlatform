اشمل "مـتم/طـرفية"؛
اشمل "مـتم/مـصفوفة"؛
اشمل "مـتم/سندات"؛
اشمل "مـحا"؛
مـحا.اشمل_ملف("Alusus/WebPlatform"، "مـنصة_ويب.أسس")؛

استخدم مـتم؛
استخدم مـنصة_ويب؛

//==============================================================================
// الخادم

@مسار_الموارد عرف مسار_الموارد: "Assets/"؛

//==============================================================================
// الواجهة

@منفذ_مرئي["/"]
@عنوان["مثال منصة الويب - صندوق التفعيل"]
دالة الرئيسية {
    عرف نص_الحالة: سـندنا[كـتابة]؛

    // بناء المشهد
    نـافذة.النموذج.الطراز.{
        الحشوة = مـسافة4.نقاط(20)؛
        الهامش = مـسافة4.نقاط(0)؛
        الاتجاه = اتـجاه._من_اليمين_؛
    }؛
    نـافذة.النموذج.حدد_المشهد(صـندوق({}).{
        الطراز.{
            الإظهار = إظـهار._مرن_؛
            النسق = نـسق._عمود_؛
            الفجوة = مـسافة.نقاط(10)؛
        }؛
        أضف_فروع({
            كـتابة(نـص("اختبار صندوق التفعيل")).{
                الطراز.{
                    حجم_الخط = مـسافة.نقاط(24.0)؛
                    سمك_الخط = 700؛
                    الهامش = مـسافة4.نقاط(0، 0، 20، 0)؛
                }؛
            }،

            كـتابة(نـص("اختر تفضيلاتك:")).{
                الطراز.{
                    حجم_الخط = مـسافة.نقاط(18.0)؛
                    الهامش = مـسافة4.نقاط(0، 0، 10، 0)؛
                }؛
            }،

            // خيارات صندوق التفعيل
            صـندوق({}).{
                الطراز.{
                    الإظهار = إظـهار._مرن_؛
                    النسق = نـسق._عمود_؛
                    الفجوة = مـسافة.نقاط(8)؛
                    الهامش = مـسافة4.نقاط(0، 0، 0، 20)؛
                }؛
                أضف_فروع({
                    صـندوق({}).{
                        الطراز.{
                            الإظهار = إظـهار._مرن_؛
                            النسق = نـسق._سطر_؛
                            الفجوة = مـسافة.نقاط(8)؛
                            المحاذاة = مـحاذاة._وسط_؛
                        }؛
                        أضف_فروع({
                            صـندوق_تفعيل(نـص("النشرة_البريدية")، 1).{
                                عند_التغيير.اربط(مغلفة (نص_الحالة: كسند)&(ودجة: سند[صـندوق_تفعيل]، حمولة: سند[صـحيح]) {
                                    إذا ودجة.مفعل {
                                        نص_الحالة.حدد_النص(نـص("النشرة البريدية: مشترك"))؛
                                    } وإلا {
                                        نص_الحالة.حدد_النص(نـص("النشرة البريدية: غير مشترك"))؛
                                    }
                                })؛
                            }،
                            كـتابة(نـص("اشترك في النشرة البريدية"))؛
                        })؛
                    }،

                    صـندوق({}).{
                        الطراز.{
                            الإظهار = إظـهار._مرن_؛
                            النسق = نـسق._سطر_؛
                            الفجوة = مـسافة.نقاط(8)؛
                            المحاذاة = مـحاذاة._وسط_؛
                        }؛
                        أضف_فروع({
                            صـندوق_تفعيل(نـص("التحديثات")).{
                                عند_التغيير.اربط(مغلفة (نص_الحالة: كسند)&(ودجة: سند[صـندوق_تفعيل]، حمولة: سند[صـحيح]) {
                                    إذا ودجة.مفعل {
                                        نص_الحالة.حدد_النص(نـص("التحديثات: مفعلة"))؛
                                    } وإلا {
                                        نص_الحالة.حدد_النص(نـص("التحديثات: معطلة"))؛
                                    }
                                })؛
                            }،
                            كـتابة(نـص("استقبل التحديثات"))؛
                        })؛
                    }،

                    صـندوق({}).{
                        الطراز.{
                            الإظهار = إظـهار._مرن_؛
                            النسق = نـسق._سطر_؛
                            الفجوة = مـسافة.نقاط(8)؛
                            المحاذاة = مـحاذاة._وسط_؛
                        }؛
                        أضف_فروع({
                            صـندوق_تفعيل(نـص("الإشعارات")).{
                                عند_التغيير.اربط(مغلفة (نص_الحالة: كسند)&(ودجة: سند[صـندوق_تفعيل]، حمولة: سند[صـحيح]) {
                                    إذا ودجة.مفعل {
                                        نص_الحالة.حدد_النص(نـص("الإشعارات: مفعلة"))؛
                                    } وإلا {
                                        نص_الحالة.حدد_النص(نـص("الإشعارات: معطلة"))؛
                                    }
                                })؛
                            }،
                            كـتابة(نـص("فعل الإشعارات"))؛
                        })؛
                    }
                })؛
            }،

            كـتابة(نـص("النشرة البريدية: مشترك")).{
                نص_الحالة = هذا~مثل[سـندنا[كـتابة]]؛
                الطراز.{
                    حجم_الخط = مـسافة.نقاط(16.0)؛
                    الهامش = مـسافة4.نقاط(20، 0، 0، 0)؛
                    سمك_الخط = سـمك_خط._سميك_؛
                }؛
            }
        })؛
    })؛

    نفذ_حلقة_معالجة_الأحداث()؛
}

دالة ابدأ_الخادم() {
    طـرفية.اطبع("تشغيل الخادم على المنفذ 8010...\nURL: http://localhost:8010/\n")؛
    ابن_وشغل_الخادم(مـصفوفة[مـؤشر_محارف]({ "listening_ports"، "8010"، "static_file_max_age"، "0" }))؛
}

ابدأ_الخادم()؛
